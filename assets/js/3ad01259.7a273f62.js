"use strict";(globalThis.webpackChunkbook=globalThis.webpackChunkbook||[]).push([[84],{8453:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>s});var i=r(6540);const t={},a=i.createContext(t);function o(n){const e=i.useContext(a);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),i.createElement(a.Provider,{value:e},n.children)}},9386:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"module2/unity/unity-visualization","title":"Unity Visualization for Digital Twins","description":"Unity provides high-fidelity visualization capabilities that complement Gazebo\'s physics simulation. This chapter covers setting up Unity for digital twin visualization and best practices for creating immersive environments.","source":"@site/docs/module2/unity/unity-visualization.md","sourceDirName":"module2/unity","slug":"/module2/unity/unity-visualization","permalink":"/physical-ai-book/docs/module2/unity/unity-visualization","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module2/unity/unity-visualization.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Unity Visualization for Digital Twins"}}');var t=r(4848),a=r(8453);const o={sidebar_position:3,title:"Unity Visualization for Digital Twins"},s="Unity Visualization for Digital Twins",l={},c=[{value:"Introduction to Unity for Digital Twins",id:"introduction-to-unity-for-digital-twins",level:2},{value:"Setting Up Unity for Digital Twin Applications",id:"setting-up-unity-for-digital-twin-applications",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Recommended Project Structure",id:"recommended-project-structure",level:3},{value:"Environment Setup",id:"environment-setup",level:2},{value:"Creating a New Digital Twin Project",id:"creating-a-new-digital-twin-project",level:3},{value:"Configuring URP Pipeline",id:"configuring-urp-pipeline",level:3},{value:"Scene Architecture",id:"scene-architecture",level:2},{value:"Digital Twin Scene Components",id:"digital-twin-scene-components",level:3},{value:"Environment Creation",id:"environment-creation",level:3},{value:"Robot and Asset Integration",id:"robot-and-asset-integration",level:2},{value:"Importing Robot Models",id:"importing-robot-models",level:3},{value:"Real-time Data Integration",id:"real-time-data-integration",level:2},{value:"Connecting to Simulation Data",id:"connecting-to-simulation-data",level:3},{value:"Advanced Visualization Techniques",id:"advanced-visualization-techniques",level:2},{value:"Shader Programming for Digital Twins",id:"shader-programming-for-digital-twins",level:3},{value:"Particle Systems for Sensor Visualization",id:"particle-systems-for-sensor-visualization",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Occlusion Culling",id:"occlusion-culling",level:3},{value:"Dynamic Batching",id:"dynamic-batching",level:3},{value:"Lighting and Atmospherics",id:"lighting-and-atmospherics",level:2},{value:"Realistic Lighting Setup",id:"realistic-lighting-setup",level:3},{value:"Best Practices for Digital Twin Visualization",id:"best-practices-for-digital-twin-visualization",level:2},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:2},{value:"Rendering Performance",id:"rendering-performance",level:3},{value:"Data Synchronization",id:"data-synchronization",level:3},{value:"Asset Loading",id:"asset-loading",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"unity-visualization-for-digital-twins",children:"Unity Visualization for Digital Twins"})}),"\n",(0,t.jsx)(e.p,{children:"Unity provides high-fidelity visualization capabilities that complement Gazebo's physics simulation. This chapter covers setting up Unity for digital twin visualization and best practices for creating immersive environments."}),"\n",(0,t.jsx)(e.h2,{id:"introduction-to-unity-for-digital-twins",children:"Introduction to Unity for Digital Twins"}),"\n",(0,t.jsx)(e.p,{children:"Unity serves as the visualization layer in digital twin applications, providing photorealistic rendering, advanced lighting, and interactive capabilities. While Gazebo excels at physics simulation, Unity offers superior graphics quality and user interaction possibilities."}),"\n",(0,t.jsx)(e.h2,{id:"setting-up-unity-for-digital-twin-applications",children:"Setting Up Unity for Digital Twin Applications"}),"\n",(0,t.jsx)(e.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Unity Hub (recommended)"}),"\n",(0,t.jsx)(e.li,{children:"Unity Editor 2021.3 LTS or later"}),"\n",(0,t.jsx)(e.li,{children:"Visual Studio or Rider for scripting"}),"\n",(0,t.jsx)(e.li,{children:"Git LFS for asset versioning"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"recommended-project-structure",children:"Recommended Project Structure"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"UnityDigitalTwin/\r\n\u251c\u2500\u2500 Assets/\r\n\u2502   \u251c\u2500\u2500 Scenes/           # Scene files\r\n\u2502   \u251c\u2500\u2500 Scripts/          # C# scripts\r\n\u2502   \u251c\u2500\u2500 Materials/        # Material definitions\r\n\u2502   \u251c\u2500\u2500 Models/           # 3D models\r\n\u2502   \u251c\u2500\u2500 Textures/         # Texture assets\r\n\u2502   \u251c\u2500\u2500 Prefabs/          # Reusable objects\r\n\u2502   \u2514\u2500\u2500 Plugins/          # Third-party plugins\r\n\u251c\u2500\u2500 Packages/             # Package Manager packages\r\n\u2514\u2500\u2500 ProjectSettings/      # Project configurations\n"})}),"\n",(0,t.jsx)(e.h2,{id:"environment-setup",children:"Environment Setup"}),"\n",(0,t.jsx)(e.h3,{id:"creating-a-new-digital-twin-project",children:"Creating a New Digital Twin Project"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Open Unity Hub and create a new 3D Core project"}),"\n",(0,t.jsxs)(e.li,{children:["Set up the following recommended settings:","\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Render Pipeline: Universal Render Pipeline (URP) for performance"}),"\n",(0,t.jsx)(e.li,{children:"Quality Settings: Balanced for real-time simulation"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"configuring-urp-pipeline",children:"Configuring URP Pipeline"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'// Example URP Asset Configuration\r\nusing UnityEngine;\r\nusing UnityEngine.Rendering.Universal;\r\n\r\npublic class DigitalTwinURPSetup : MonoBehaviour\r\n{\r\n    [Header("Quality Settings")]\r\n    public int shadowResolution = 1024;\r\n    public float shadowDistance = 50f;\r\n    public int antiAliasing = 2; // MSAA\r\n\r\n    void Start()\r\n    {\r\n        // Configure rendering settings for digital twin\r\n        var universalRenderPipelineAsset = GraphicsSettings.renderPipelineAsset as UniversalRenderPipelineAsset;\r\n        if (universalRenderPipelineAsset != null)\r\n        {\r\n            universalRenderPipelineAsset.shadowDistance = shadowDistance;\r\n            universalRenderPipelineAsset.shadowCascadeCount = 2;\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"scene-architecture",children:"Scene Architecture"}),"\n",(0,t.jsx)(e.h3,{id:"digital-twin-scene-components",children:"Digital Twin Scene Components"}),"\n",(0,t.jsx)(e.p,{children:"A typical digital twin scene consists of:"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Environment"}),": Physical space representation"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Assets"}),": Robots, equipment, and dynamic elements"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Cameras"}),": Multiple viewpoints for monitoring"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Lighting"}),": Realistic illumination"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"UI Elements"}),": Status displays and controls"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"environment-creation",children:"Environment Creation"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'using UnityEngine;\r\n\r\npublic class EnvironmentBuilder : MonoBehaviour\r\n{\r\n    [Header("Terrain Settings")]\r\n    public float terrainWidth = 100f;\r\n    public float terrainHeight = 100f;\r\n    public AnimationCurve heightMap = AnimationCurve.Linear(0, 0, 1, 1);\r\n\r\n    [Header("Building Parameters")]\r\n    public Vector3 buildingSize = new Vector3(10f, 5f, 15f);\r\n    public Transform buildingParent;\r\n\r\n    void Start()\r\n    {\r\n        CreateTerrain();\r\n        CreateBuildings();\r\n    }\r\n\r\n    void CreateTerrain()\r\n    {\r\n        // Create terrain programmatically\r\n        Terrain terrain = Terrain.CreateEcosystemTerrain();\r\n        terrain.terrainData.size = new Vector3(terrainWidth, 10f, terrainHeight);\r\n\r\n        // Apply heightmap\r\n        float[,] heights = new float[terrain.terrainData.heightmapResolution,\r\n                                   terrain.terrainData.heightmapResolution];\r\n\r\n        for (int x = 0; x < terrain.terrainData.heightmapResolution; x++)\r\n        {\r\n            for (int z = 0; z < terrain.terrainData.heightmapResolution; z++)\r\n            {\r\n                float xPercent = (float)x / (terrain.terrainData.heightmapResolution - 1);\r\n                float zPercent = (float)z / (terrain.terrainData.heightmapResolution - 1);\r\n\r\n                heights[x, z] = heightMap.Evaluate(xPercent) * heightMap.Evaluate(zPercent);\r\n            }\r\n        }\r\n\r\n        terrain.terrainData.SetHeights(0, 0, heights);\r\n    }\r\n\r\n    void CreateBuildings()\r\n    {\r\n        // Instantiate building prefabs\r\n        for (int i = 0; i < 5; i++)\r\n        {\r\n            GameObject building = GameObject.CreatePrimitive(PrimitiveType.Cube);\r\n            building.transform.position = new Vector3(\r\n                Random.Range(-terrainWidth/2, terrainWidth/2),\r\n                buildingSize.y/2,\r\n                Random.Range(-terrainHeight/2, terrainHeight/2)\r\n            );\r\n            building.transform.localScale = buildingSize;\r\n            building.transform.parent = buildingParent;\r\n\r\n            // Apply building material\r\n            building.GetComponent<Renderer>().material = Resources.Load<Material>("BuildingMat");\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"robot-and-asset-integration",children:"Robot and Asset Integration"}),"\n",(0,t.jsx)(e.h3,{id:"importing-robot-models",children:"Importing Robot Models"}),"\n",(0,t.jsx)(e.p,{children:"Unity supports various 3D model formats (FBX, OBJ, glTF). For digital twins, consider:"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"LOD Systems"}),": Multiple detail levels for performance"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Skinned Meshes"}),": For articulated robots"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Optimized Geometry"}),": Reduced polygon counts for real-time performance"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'using UnityEngine;\r\n\r\npublic class RobotImporter : MonoBehaviour\r\n{\r\n    [Header("Robot Configuration")]\r\n    public GameObject robotPrefab;\r\n    public Transform spawnPoint;\r\n    public bool useLOD = true;\r\n\r\n    [Header("Animation Rigging")]\r\n    public bool enableRigging = true;\r\n\r\n    void Start()\r\n    {\r\n        SpawnRobot();\r\n    }\r\n\r\n    void SpawnRobot()\r\n    {\r\n        GameObject robotInstance = Instantiate(robotPrefab, spawnPoint.position, spawnPoint.rotation);\r\n\r\n        if (useLOD)\r\n        {\r\n            SetupLODGroup(robotInstance);\r\n        }\r\n\r\n        if (enableRigging)\r\n        {\r\n            SetupAnimationRigging(robotInstance);\r\n        }\r\n    }\r\n\r\n    void SetupLODGroup(GameObject robot)\r\n    {\r\n        LODGroup lodGroup = robot.AddComponent<LODGroup>();\r\n\r\n        Renderer[] renderers = robot.GetComponentsInChildren<Renderer>();\r\n\r\n        LOD[] lods = new LOD[3];\r\n\r\n        // LOD 0: High detail (distance 0-20m)\r\n        lods[0] = new LOD(0.5f, renderers);\r\n\r\n        // LOD 1: Medium detail (distance 20-50m)\r\n        Renderer[] mediumLODRenderers = GetMediumLODRenderers(renderers);\r\n        lods[1] = new LOD(0.25f, mediumLODRenderers);\r\n\r\n        // LOD 2: Low detail (distance 50m+)\r\n        Renderer[] lowLODRenderers = GetLowLODRenderers(renderers);\r\n        lods[2] = new LOD(0.1f, lowLODRenderers);\r\n\r\n        lodGroup.SetLODs(lods);\r\n        lodGroup.RecalculateBounds();\r\n    }\r\n\r\n    Renderer[] GetMediumLODRenderers(Renderer[] original)\r\n    {\r\n        // Implementation for medium detail renderers\r\n        return original;\r\n    }\r\n\r\n    Renderer[] GetLowLODRenderers(Renderer[] original)\r\n    {\r\n        // Implementation for low detail renderers\r\n        return new Renderer[0];\r\n    }\r\n\r\n    void SetupAnimationRigging(GameObject robot)\r\n    {\r\n        // Setup animation rigging for articulated parts\r\n        // Requires Animation Rigging package\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"real-time-data-integration",children:"Real-time Data Integration"}),"\n",(0,t.jsx)(e.h3,{id:"connecting-to-simulation-data",children:"Connecting to Simulation Data"}),"\n",(0,t.jsx)(e.p,{children:"Unity can receive real-time data from Gazebo through various protocols:"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"ROS Bridge"}),": Using rosbridge_suite"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Custom TCP/UDP"}),": Direct socket communication"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"REST APIs"}),": For simpler data exchange"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'using System.Collections;\r\nusing System.Collections.Generic;\r\nusing UnityEngine;\r\nusing System.Net.Sockets;\r\nusing System.Text;\r\n\r\npublic class DataReceiver : MonoBehaviour\r\n{\r\n    [Header("Connection Settings")]\r\n    public string ipAddress = "127.0.0.1";\r\n    public int port = 5000;\r\n\r\n    [Header("Robot Data")]\r\n    public Transform robotTransform;\r\n    public List<Transform> jointTransforms = new List<Transform>();\r\n\r\n    private TcpClient tcpClient;\r\n    private NetworkStream stream;\r\n\r\n    void Start()\r\n    {\r\n        ConnectToSimulation();\r\n    }\r\n\r\n    void ConnectToSimulation()\r\n    {\r\n        try\r\n        {\r\n            tcpClient = new TcpClient(ipAddress, port);\r\n            stream = tcpClient.GetStream();\r\n\r\n            StartCoroutine(ReceiveData());\r\n        }\r\n        catch (System.Exception e)\r\n        {\r\n            Debug.LogError($"Failed to connect: {e.Message}");\r\n        }\r\n    }\r\n\r\n    IEnumerator ReceiveData()\r\n    {\r\n        byte[] buffer = new byte[1024];\r\n\r\n        while (tcpClient.Connected)\r\n        {\r\n            yield return new WaitForSeconds(0.01f); // ~100Hz update\r\n\r\n            if (stream.DataAvailable)\r\n            {\r\n                int bytesRead = stream.Read(buffer, 0, buffer.Length);\r\n                string data = Encoding.UTF8.GetString(buffer, 0, bytesRead);\r\n\r\n                ProcessSimulationData(data);\r\n            }\r\n        }\r\n    }\r\n\r\n    void ProcessSimulationData(string jsonData)\r\n    {\r\n        // Parse JSON data from Gazebo\r\n        RobotState state = JsonUtility.FromJson<RobotState>(jsonData);\r\n\r\n        // Update robot position and orientation\r\n        robotTransform.position = new Vector3(state.x, state.y, state.z);\r\n        robotTransform.rotation = Quaternion.Euler(state.roll, state.pitch, state.yaw);\r\n\r\n        // Update joint positions\r\n        for (int i = 0; i < jointTransforms.Count && i < state.jointPositions.Count; i++)\r\n        {\r\n            jointTransforms[i].localRotation = Quaternion.Euler(\r\n                0, 0, state.jointPositions[i] * Mathf.Rad2Deg\r\n            );\r\n        }\r\n    }\r\n\r\n    [System.Serializable]\r\n    public class RobotState\r\n    {\r\n        public float x, y, z;\r\n        public float roll, pitch, yaw;\r\n        public List<float> jointPositions = new List<float>();\r\n    }\r\n\r\n    void OnDestroy()\r\n    {\r\n        if (tcpClient != null)\r\n        {\r\n            tcpClient.Close();\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"advanced-visualization-techniques",children:"Advanced Visualization Techniques"}),"\n",(0,t.jsx)(e.h3,{id:"shader-programming-for-digital-twins",children:"Shader Programming for Digital Twins"}),"\n",(0,t.jsx)(e.p,{children:"Custom shaders can enhance the visualization of digital twin data:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-hlsl",children:'// RobotHighlight.shader\r\nShader "DigitalTwin/RobotHighlight"\r\n{\r\n    Properties\r\n    {\r\n        _MainTex ("Texture", 2D) = "white" {}\r\n        _Color ("Color", Color) = (1,1,1,1)\r\n        _HighlightColor ("Highlight Color", Color) = (0.2, 0.8, 1, 1)\r\n        _HighlightPower ("Highlight Power", Range(0, 1)) = 0.5\r\n        _EdgeThickness ("Edge Thickness", Range(0, 1)) = 0.5\r\n    }\r\n    SubShader\r\n    {\r\n        Tags { "RenderType"="Opaque" }\r\n        LOD 100\r\n\r\n        Pass\r\n        {\r\n            CGPROGRAM\r\n            #pragma vertex vert\r\n            #pragma fragment frag\r\n            #include "UnityCG.cginc"\r\n\r\n            struct appdata\r\n            {\r\n                float4 vertex : POSITION;\r\n                float2 uv : TEXCOORD0;\r\n                float3 normal : NORMAL;\r\n            };\r\n\r\n            struct v2f\r\n            {\r\n                float2 uv : TEXCOORD0;\r\n                float4 vertex : SV_POSITION;\r\n                float3 worldNormal : TEXCOORD1;\r\n                float3 worldPos : TEXCOORD2;\r\n            };\r\n\r\n            sampler2D _MainTex;\r\n            float4 _MainTex_ST;\r\n            float4 _Color;\r\n            float4 _HighlightColor;\r\n            float _HighlightPower;\r\n            float _EdgeThickness;\r\n\r\n            v2f vert (appdata v)\r\n            {\r\n                v2f o;\r\n                o.vertex = UnityObjectToClipPos(v.vertex);\r\n                o.uv = TRANSFORM_TEX(v.uv, _MainTex);\r\n                o.worldNormal = mul((float3x3)unity_WorldToObject, v.normal);\r\n                o.worldPos = mul(unity_ObjectToWorld, v.vertex).xyz;\r\n                return o;\r\n            }\r\n\r\n            fixed4 frag (v2f i) : SV_Target\r\n            {\r\n                fixed4 col = tex2D(_MainTex, i.uv) * _Color;\r\n\r\n                // Calculate rim lighting for highlighting\r\n                float3 viewDir = normalize(_WorldSpaceCameraPos - i.worldPos);\r\n                float rim = 1.0 - saturate(dot(normalize(i.worldNormal), viewDir));\r\n                rim = pow(rim, 1.0 / _EdgeThickness);\r\n\r\n                // Blend with highlight color\r\n                col.rgb = lerp(col.rgb, _HighlightColor.rgb, rim * _HighlightPower);\r\n\r\n                return col;\r\n            }\r\n            ENDCG\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"particle-systems-for-sensor-visualization",children:"Particle Systems for Sensor Visualization"}),"\n",(0,t.jsx)(e.p,{children:"Visualize sensor data using particle systems:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'using UnityEngine;\r\n\r\npublic class SensorVisualization : MonoBehaviour\r\n{\r\n    [Header("LiDAR Visualization")]\r\n    public ParticleSystem lidarParticleSystem;\r\n    public Transform robotBase;\r\n\r\n    [Header("Camera Feed")]\r\n    public RenderTexture cameraFeedTexture;\r\n    public RawImage cameraDisplay;\r\n\r\n    [Header("Data Mapping")]\r\n    public float maxRange = 30f;\r\n    public Color minDistanceColor = Color.red;\r\n    public Color maxDistanceColor = Color.blue;\r\n\r\n    public void UpdateLiDARVisualization(float[] ranges, Vector3[] directions)\r\n    {\r\n        if (lidarParticleSystem == null) return;\r\n\r\n        var main = lidarParticleSystem.main;\r\n        main.maxParticles = ranges.Length;\r\n\r\n        var emission = lidarParticleSystem.emission;\r\n        emission.rateOverTime = ranges.Length;\r\n\r\n        ParticleSystem.Particle[] particles = new ParticleSystem.Particle[ranges.Length];\r\n\r\n        for (int i = 0; i < ranges.Length; i++)\r\n        {\r\n            particles[i].position = robotBase.position +\r\n                                  robotBase.TransformDirection(directions[i]) * ranges[i];\r\n            particles[i].startSize = 0.1f;\r\n            particles[i].startColor = Color.Lerp(minDistanceColor, maxDistanceColor,\r\n                                               ranges[i] / maxRange);\r\n            particles[i].remainingLifetime = 0.5f;\r\n            particles[i].startLifetime = 0.5f;\r\n        }\r\n\r\n        lidarParticleSystem.SetParticles(particles, particles.Length);\r\n    }\r\n\r\n    public void UpdateCameraFeed(Texture cameraTexture)\r\n    {\r\n        if (cameraFeedTexture != null)\r\n        {\r\n            Graphics.Blit(cameraTexture, cameraFeedTexture);\r\n            cameraDisplay.texture = cameraFeedTexture;\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,t.jsx)(e.h3,{id:"occlusion-culling",children:"Occlusion Culling"}),"\n",(0,t.jsx)(e.p,{children:"Implement occlusion culling for complex scenes:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'using UnityEngine;\r\n\r\npublic class OcclusionCullingManager : MonoBehaviour\r\n{\r\n    [Header("Occlusion Settings")]\r\n    public LayerMask occluderLayers;\r\n    public float updateInterval = 0.1f;\r\n\r\n    private Camera mainCamera;\r\n    private WaitForSeconds updateDelay;\r\n\r\n    void Start()\r\n    {\r\n        mainCamera = Camera.main;\r\n        updateDelay = new WaitForSeconds(updateInterval);\r\n\r\n        StartCoroutine(OcclusionUpdateRoutine());\r\n    }\r\n\r\n    IEnumerator OcclusionUpdateRoutine()\r\n    {\r\n        while (true)\r\n        {\r\n            UpdateOcclusion();\r\n            yield return updateDelay;\r\n        }\r\n    }\r\n\r\n    void UpdateOcclusion()\r\n    {\r\n        // Perform occlusion queries for distant objects\r\n        // Disable rendering for occluded objects\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"dynamic-batching",children:"Dynamic Batching"}),"\n",(0,t.jsx)(e.p,{children:"Configure Unity for optimal performance with many small objects:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'using UnityEngine;\r\n\r\npublic class BatchOptimizer : MonoBehaviour\r\n{\r\n    [Header("Batching Settings")]\r\n    public bool enableDynamicBatching = true;\r\n    public bool enableStaticBatching = true;\r\n\r\n    void Start()\r\n    {\r\n        // Static batching is enabled by default\r\n        // Dynamic batching can be configured\r\n\r\n        OptimizeMaterials();\r\n    }\r\n\r\n    void OptimizeMaterials()\r\n    {\r\n        // Use shared materials to enable batching\r\n        Renderer[] renderers = FindObjectsOfType<Renderer>();\r\n\r\n        foreach (Renderer renderer in renderers)\r\n        {\r\n            // Ensure all similar objects use the same material instance\r\n            if (renderer.sharedMaterials.Length > 0)\r\n            {\r\n                Material sharedMat = renderer.sharedMaterials[0];\r\n                renderer.material = sharedMat; // Use instance instead of shared\r\n            }\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"lighting-and-atmospherics",children:"Lighting and Atmospherics"}),"\n",(0,t.jsx)(e.h3,{id:"realistic-lighting-setup",children:"Realistic Lighting Setup"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'using UnityEngine;\r\n\r\npublic class DigitalTwinLighting : MonoBehaviour\r\n{\r\n    [Header("Sun Light")]\r\n    public Light sunLight;\r\n    public Gradient dayNightCycle;\r\n\r\n    [Header("Atmospheric Scattering")]\r\n    public float atmosphericScattering = 0.1f;\r\n\r\n    [Header("Indoor Lighting")]\r\n    public GameObject[] indoorLights;\r\n\r\n    void Start()\r\n    {\r\n        SetupLighting();\r\n    }\r\n\r\n    void SetupLighting()\r\n    {\r\n        if (sunLight != null)\r\n        {\r\n            sunLight.type = LightType.Directional;\r\n            sunLight.intensity = 1.0f;\r\n            sunLight.shadows = LightShadows.Soft;\r\n            sunLight.shadowStrength = 0.8f;\r\n            sunLight.shadowResolution = ShadowResolution.High;\r\n        }\r\n\r\n        // Configure atmospheric effects\r\n        RenderSettings.fog = true;\r\n        RenderSettings.fogMode = FogMode.ExponentialSquared;\r\n        RenderSettings.fogDensity = atmosphericScattering;\r\n    }\r\n\r\n    public void SetTimeOfDay(float time) // 0-24 hour format\r\n    {\r\n        float normalizedTime = time / 24f;\r\n\r\n        if (sunLight != null)\r\n        {\r\n            // Rotate sun based on time of day\r\n            sunLight.transform.rotation = Quaternion.Euler(\r\n                90 - (normalizedTime * 360) % 180,\r\n                0,\r\n                0\r\n            );\r\n\r\n            // Adjust color based on day/night cycle\r\n            sunLight.color = dayNightCycle.Evaluate(normalizedTime);\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"best-practices-for-digital-twin-visualization",children:"Best Practices for Digital Twin Visualization"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Performance First"}),": Optimize for real-time rendering requirements"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Consistent Coordinate Systems"}),": Match Unity and Gazebo coordinate conventions"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Modular Architecture"}),": Use prefabs and components for reusability"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Data-Driven Design"}),": Separate visualization from simulation data"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Quality Settings"}),": Provide scalable quality options for different hardware"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Version Control"}),": Use Git LFS for large asset files"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,t.jsx)(e.h3,{id:"rendering-performance",children:"Rendering Performance"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Use occlusion culling for large environments"}),"\n",(0,t.jsx)(e.li,{children:"Implement Level of Detail (LOD) systems"}),"\n",(0,t.jsx)(e.li,{children:"Optimize shader complexity"}),"\n",(0,t.jsx)(e.li,{children:"Reduce draw calls through batching"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"data-synchronization",children:"Data Synchronization"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Ensure consistent coordinate systems between Gazebo and Unity"}),"\n",(0,t.jsx)(e.li,{children:"Handle network latency appropriately"}),"\n",(0,t.jsx)(e.li,{children:"Validate data integrity and bounds"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"asset-loading",children:"Asset Loading"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Preload critical assets during initialization"}),"\n",(0,t.jsx)(e.li,{children:"Use async loading for large models"}),"\n",(0,t.jsx)(e.li,{children:"Implement object pooling for frequently instantiated objects"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsx)(e.p,{children:"In the following chapter, we'll explore how to integrate Gazebo and Unity for seamless digital twin operation, covering communication protocols and synchronization mechanisms."})]})}function u(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}}}]);